---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r cellcomp_libs, echo=FALSE, results='hide', include=FALSE}
library(dplyr)
library(knitr)
library(tibble)
library(tidyr)

library(xCell)
library(NMF)
```

```{r cellcomp_xcell, results='hide'}
emat_pact <- as.matrix(emat[, grepl('^PACT', colnames(emat))])

xcell <- xCellAnalysis(as.matrix(emat_pact))
xcell_t  <-  read.table("../data/xcell_types.txt", header=TRUE, sep="\t")
xcell_lym <- xcell[row.names(xcell) %in% xcell_t$Cell.types[xcell_t$Group=="Lymphocytes"],]
xcell_nonhem <- xcell[row.names(xcell) %in% xcell_t$Cell.types[xcell_t$Group=="Non-Hematopoietic"],]
xcell_nonlym <- xcell[row.names(xcell) %in% xcell_t$Cell.types[xcell_t$Group=="Non-lymphocytes"],]
```

## Cellular Composition {.tabset .tabset-fade}

### Lymphocytes

Cellular composition was calculated using gene set enrichment analysis with X-cell [(Aran et al. Genome Biology 2017)](https://link.springer.com/epdf/10.1186/s13059-017-1349-1?author_access_token=DVtns3PR3raQv61Z6RD4Ym_BpE1tBhCbnbw3BuzI2RO7SD-w75iAhrQ7gjSGzw_zJO6jHEpDqZzy8CsttNZVysUprXQi0WGX-FRCguKfv2d96DcweRBG2ni-01x6T6bpU3-cfZ5nkfzCQeNeg-mMUQ%3D%3D)

```{r cellcomp_lym, echo=FALSE, warning=FALSE, message=FALSE}
aheatmap(xcell_lym, scale = "row")

```

### Myeloid

Cellular composition was calculated using gene set enrichment analysis with X-cell [(Aran et al. Genome Biology 2017)](https://link.springer.com/epdf/10.1186/s13059-017-1349-1?author_access_token=DVtns3PR3raQv61Z6RD4Ym_BpE1tBhCbnbw3BuzI2RO7SD-w75iAhrQ7gjSGzw_zJO6jHEpDqZzy8CsttNZVysUprXQi0WGX-FRCguKfv2d96DcweRBG2ni-01x6T6bpU3-cfZ5nkfzCQeNeg-mMUQ%3D%3D)

```{r cellcomp_nonlym, echo=FALSE, warning=FALSE, message=FALSE}
aheatmap(xcell_nonlym, scale = "row")

```

### Stroma/Epithelial

Cellular composition was calculated using gene set enrichment analysis with X-cell [(Aran et al. Genome Biology 2017)](https://link.springer.com/epdf/10.1186/s13059-017-1349-1?author_access_token=DVtns3PR3raQv61Z6RD4Ym_BpE1tBhCbnbw3BuzI2RO7SD-w75iAhrQ7gjSGzw_zJO6jHEpDqZzy8CsttNZVysUprXQi0WGX-FRCguKfv2d96DcweRBG2ni-01x6T6bpU3-cfZ5nkfzCQeNeg-mMUQ%3D%3D)

```{r cellcomp_nonhem, echo=FALSE, warning=FALSE, message=FALSE}
aheatmap(xcell_nonhem, scale = "row")

```

##
